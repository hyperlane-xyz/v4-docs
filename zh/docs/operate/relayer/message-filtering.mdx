---
title: "消息过滤"
description: "配置要中继哪些消息以及忽略哪些消息"
---

默认情况下，Relayer 会尝试传递从其源链发送到任何已配置目标链的消息。

Relayer 可能希望进一步过滤它们尝试传递的消息。例如，构建跨链应用程序的人可能希望运行一个仅传递发送到该应用程序的消息的 Relayer。同样，某些 Relayer 可能希望仅将消息中继到可用链的子集。

Relayer 可以通过设置 `--whitelist` 或 `--blacklist` 环境变量来**可选地**过滤它们传递的消息。另请参阅[配置参考](/zh/docs/operate/config/config-reference)的 whitelist 部分。

这些配置是字符串化的 JSON 对象，格式如下：

```typescript
// A list of matching rules. A message matches if any of the list
// elements matches the message.
type MatchingList = Array<ListElement>;

// Matches a message if any of the provided values matches.
interface ListElement {
  originDomain?: NumericFilter;
  senderAddress?: HashFilter;
  destinationDomain?: NumericFilter;
  recipientAddress?: HashFilter;
}

type NumericFilter = Wildcard | U32 | Array<U32>;
type HashFilter = Wildcard | H256 | Array<H256>;

// 32-bit unsigned integer
type U32 = number | string;

// 256-bit hash (can also be less) encoded as hextype H256 = string;

// Matches anything
type Wildcard = "*";
```

whitelist 和 blacklist 都具有"any"语义。换句话说，Relayer 将传递与 whitelist 过滤器中_任何一个_匹配的消息，并忽略与 blacklist 过滤器中_任何一个_匹配的消息。

例如，以下配置用作 whitelist 将确保 Relayer 中继发送到 Ethereum 的任何消息、从地址 `0xca7f632e91B592178D83A70B404f398c0a51581F` 发送到 Celo 或 Avalanche 的任何消息，以及发送到 Arbitrum 或 Optimism 上地址 `0xca7f632e91B592178D83A70B404f398c0a51581F` 的任何消息。

```json
[
  { "senderAddress": "*", "destinationDomain": ["1"], "recipientAddress": "*" },
  {
    "senderAddress": "0xca7f632e91B592178D83A70B404f398c0a51581F",
    "destinationDomain": ["42220", "43114"],
    "recipientAddress": "*"
  },
  {
    "senderAddress": "*",
    "destinationDomain": ["42161", "420"],
    "recipientAddress": "0xca7f632e91B592178D83A70B404f398c0a51581F"
  }
]
```

有效的配置可能如下所示：

```bash
--whitelist='[
    {"senderAddress":"*",
    "destinationDomain":["1"],
    "recipientAddress":"*"},
    {"senderAddress":"0xca7f632e91B592178D83A70B404f398c0a51581F",
    "destinationDomain":["42220","43114"],
    "recipientAddress":"*"},
    {"senderAddress":"*",
    "destinationDomain":["42161","420"],
    "recipientAddress":"0xca7f632e91B592178D83A70B404f398c0a51581F"}
    ]'
```

blacklist 优先于 whitelist，即如果消息同时匹配 whitelist _和_ blacklist，它将不会被传递。
